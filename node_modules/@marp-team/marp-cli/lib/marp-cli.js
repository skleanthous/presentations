"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("chalk")),i=e(require("yargs/yargs")),o=e(require("strip-ansi")),r=e(require("wrap-ansi")),n=require("yargs"),s=require("@marp-team/marp-core"),a=require("cosmiconfig"),p=e(require("path")),d=e(require("fs")),c=e(require("os-locale")),l=require("util"),u=require("url"),h=e(u),b=e(require("puppeteer-core")),m=require("child_process"),f=e(require("os")),v=require("chrome-launcher"),g=e(require("file-url")),y=e(require("get-stdin")),k=require("globby"),w=e(k),x=e(require("mkdirp")),M=require("tmp"),I=require("@marp-team/marpit"),N=e(require("chokidar")),P=e(require("crypto")),S=e(require("portfinder")),j=require("ws"),A=e(require("pkg-up")),z=e(require("import-from")),D=e(require("carlo")),T=require("events"),C=e(require("express")),O=e(require("querystring")),Z=e(require("serve-index"));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function L(e,t,i,o){return new(i||(i=Promise))((function(r,n){function s(e){try{p(o.next(e))}catch(e){n(e)}}function a(e){try{p(o.throw(e))}catch(e){n(e)}}function p(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}p((o=o.apply(e,t||[])).next())}))}const B=n.terminalWidth()||80,F=(e,t,i)=>{const n=o(e).length+1;return`${e} ${(i.singleLine?t:r(t,B-n)).split("\n").join("\n"+" ".repeat(n))}`};let R=!1;function W(e){R=e}function q(e,i={}){R||console.warn(F(t.bgCyan.black("[  INFO ]"),e,i))}function H(e,i={}){R||console.warn(F(t.bgYellow.black("[  WARN ]"),e,i))}function E(e,i={}){console.error(F(t.bgRed.white("[ ERROR ]"),e,i))}const U=l.promisify(m.exec);let J,X,Y=!1;function V(){return void 0===J&&(J=require("is-wsl")),J}const $=e=>L(void 0,void 0,void 0,(function*(){return(yield U("wslpath -m "+e.replace(/\\/g,"\\\\"))).stdout.trim()})),G=e=>L(void 0,void 0,void 0,(function*(){if(V()){if(void 0===X){const e=(yield U("cmd.exe /c SET TMP")).stdout.trim();e.startsWith("TMP=")&&(X=e.slice(4))}if(void 0!==X)return p.win32.resolve(X,e)}return p.resolve(f.tmpdir(),e)}));function Q(){return L(this,void 0,void 0,(function*(){const e=new Set;return(process.env.IS_DOCKER||V())&&e.add("--no-sandbox"),(process.env.IS_DOCKER||process.env.CI)&&e.add("--disable-features=VizDisplayCompositor"),!1===Y&&(process.env.IS_DOCKER?Y="/usr/bin/chromium-browser":[Y]=v.Launcher.getInstallations()),{executablePath:Y,args:[...e]}}))}function _({marpit:e}){Object.assign(e.customDirectives.global,{description:e=>"string"==typeof e?{marpCLIDescription:e}:{},image:e=>"string"==typeof e?{marpCLIImage:e}:{},title:e=>"string"==typeof e?{marpCLITitle:e}:{},url:e=>{try{e&&new u.URL(e)}catch(t){return H("Specified canonical URL is ignored since invalid URL: "+e),{}}return{marpCLIURL:e}}})}const K=Symbol();function ee(e){const{marpit:t}=e;e.core.ruler.push("marp_cli_info",e=>{var i;if(e.inlineMode)return;const{themeSet:o,lastGlobalDirectives:r}=t,n=r||{},s=n.theme||(o.default||{}).name,a={theme:s,description:n.marpCLIDescription,image:n.marpCLIImage,title:n.marpCLITitle,url:n.marpCLIURL,size:{height:o.getThemeProp(s,"heightPixel"),width:o.getThemeProp(s,"widthPixel")},length:0};for(const t of e.tokens)1===(null===(i=t.meta)||void 0===i?void 0:i.marpitSlideElement)&&(a.length+=1);t[K]=a})}class te{constructor(e,t=1){this.name="CLIError",this.message=e,this.errorCode=t}toString(){return this.message}}function ie(e,t=1){throw new te(e,t)}const oe=l.promisify(d.stat),re=l.promisify(d.readFile),ne=l.promisify(M.tmpName),se=l.promisify(d.unlink),ae=l.promisify(d.writeFile),pe=["md","mdown","markdown","markdn"];var de;!function(e){e[e.File=0]="File",e[e.StandardIO=1]="StandardIO",e[e.Null=2]="Null"}(de||(de={}));class ce{constructor(e){this.type=de.File,this.path=e}get absolutePath(){return p.resolve(this.path)}get absoluteFileScheme(){return u.pathToFileURL?u.pathToFileURL(this.absolutePath).toString():g(this.absolutePath)}convert(e,t){switch(e){case void 0:return ce.initialize(this.convertName(t),e=>e.type=this.type);case!1:return ce.initialize(this.path,e=>e.type=de.Null);case"-":return ce.initialize("-",e=>e.type=de.StandardIO)}return this.inputDir?ce.initialize(this.convertName(Object.assign(Object.assign({},t),{basePath:p.join(e,this.relativePath(this.inputDir))}))):ce.initialize(this.convertName(Object.assign(Object.assign({},t),{extension:void 0,basePath:e})))}load(){return L(this,void 0,void 0,(function*(){return this.buffer=this.buffer||(yield re(this.path)),this.buffer}))}relativePath(e=process.cwd()){return p.relative(e,this.absolutePath)}save(){return L(this,void 0,void 0,(function*(){switch(this.type){case de.File:yield this.saveToFile();break;case de.StandardIO:process.stdout.write(this.buffer)}}))}saveTmpFile(e={}){return L(this,void 0,void 0,(function*(){const t=yield ne({dir:e.home?f.homedir():void 0,postfix:e.extension});return yield this.saveToFile(t),{cleanup:()=>L(this,void 0,void 0,(function*(){try{yield this.cleanup(t)}catch(e){}})),path:t}}))}cleanup(e){return se(e)}convertName(e={}){const{basePath:t,extension:i,page:o}=Object.assign({basePath:this.path},e);let r=t;if(void 0!==i&&(r=p.join(p.dirname(t),`${p.basename(t,p.extname(t))}.${i}`)),void 0!==o){const e=p.extname(r),t=o.toString().padStart(3,"0");r=p.join(p.dirname(r),`${p.basename(r,e)}.${t}${e}`)}return r}saveToFile(e=this.path){return L(this,void 0,void 0,(function*(){yield x(p.dirname(p.resolve(e))),yield ae(e,this.buffer)}))}static findPath(e,...t){return L(this,void 0,void 0,(function*(){const i=new Set,o=[];for(const e of t){try{if((yield oe(e)).isFile()){i.add(p.resolve(e));continue}}catch(e){}o.push(e.split(p.sep).join("/"))}return(yield w(o,Object.assign({absolute:!0,ignore:["**/node_modules"]},e))).forEach(e=>i.add(e)),[...i.values()].map(e=>p.normalize(e))}))}static find(...e){return L(this,void 0,void 0,(function*(){return(yield this.findPath({expandDirectories:{extensions:[],files:pe.map(e=>"*."+e)}},...e)).map(e=>new ce(e))}))}static findDir(e){return L(this,void 0,void 0,(function*(){const t=yield this.find(e);return t.forEach(t=>t.inputDir=p.resolve(e)),t}))}static stdin(){return L(this,void 0,void 0,(function*(){if(this.stdinBuffer=this.stdinBuffer||(yield y.buffer()),0!==this.stdinBuffer.length)return this.initialize("-",e=>{e.buffer=this.stdinBuffer,e.type=de.StandardIO})}))}static initialize(e,t=(()=>{})){const i=new this(e);return t(i),i}}var le=Object.prototype.hasOwnProperty;function ue(e,t){return Array.isArray(e)?function(e,t){for(var i,o="",r="",n=Array.isArray(t),s=0;s<e.length;s++)(i=ue(e[s]))&&(n&&t[s]&&(i=fe(i)),o=o+r+i,r=" ");return o}(e,t):e&&"object"==typeof e?function(e){var t="",i="";for(var o in e)o&&e[o]&&le.call(e,o)&&(t=t+i+o,i=" ");return t}(e):e||""}function he(e){if(!e)return"";if("object"==typeof e){var t="";for(var i in e)le.call(e,i)&&(t=t+i+":"+e[i]+";");return t}return e+""}function be(e,t,i,o){if(!1===t||null==t||!t&&("class"===e||"style"===e))return"";if(!0===t)return" "+(o?e:e+'="'+e+'"');var r=typeof t;return"object"!==r&&"function"!==r||"function"!=typeof t.toJSON||(t=t.toJSON()),"string"==typeof t||(t=JSON.stringify(t),i||-1===t.indexOf('"'))?(i&&(t=fe(t))," "+e+'="'+t+'"'):" "+e+"='"+t.replace(/'/g,"&#39;")+"'"}var me=/["&<>]/;function fe(e){var t=""+e,i=me.exec(t);if(!i)return e;var o,r,n,s="";for(o=i.index,r=0;o<t.length;o++){switch(t.charCodeAt(o)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}r!==o&&(s+=t.substring(r,o)),r=o+1,s+=n}return r!==o?s+t.substring(r,o):s}var ve={merge:function e(t,i){if(1===arguments.length){for(var o=t[0],r=1;r<t.length;r++)o=e(o,t[r]);return o}for(var n in i)if("class"===n){var s=t[n]||[];t[n]=(Array.isArray(s)?s:[s]).concat(i[n]||[])}else if("style"===n){s=(s=he(t[n]))&&";"!==s[s.length-1]?s+";":s;var a=he(i[n]);a=a&&";"!==a[a.length-1]?a+";":a,t[n]=s+a}else t[n]=i[n];return t},classes:ue,style:he,attr:be,attrs:function(e,t){var i="";for(var o in e)if(le.call(e,o)){var r=e[o];if("class"===o){r=ue(r),i=be(o,r,!1,t)+i;continue}"style"===o&&(r=he(r)),i+=be(o,r,!1,t)}return i},escape:fe,rethrow:function e(t,i,o,r){if(!(t instanceof Error))throw t;if(!("undefined"==typeof window&&i||r))throw t.message+=" on line "+o,t;try{r=r||d.readFileSync(i,"utf8")}catch(i){e(t,null,o)}var n=3,s=r.split("\n"),a=Math.max(o-n,0),p=Math.min(s.length,o+n);n=s.slice(a,p).map((function(e,t){var i=t+a+1;return(i==o?"  > ":"    ")+i+"| "+e})).join("\n");throw t.path=i,t.message=(i||"Pug")+":"+o+"\n"+n+"\n\n"+t.message,t}};function ge(e){var t,i="";try{var o={},r=e||{};(function(e,o,r,n,s,a,p,d,c,l){i=(i+="<!DOCTYPE html>")+"<html"+ve.attr("lang",p,!0,!0)+">",i+="<head>",o&&(i=i+"<base"+ve.attr("href",o,!0,!0)+">"),d&&(i=(i=(i+="<title>")+ve.escape(null==(t=d)?"":t)+"</title>")+'<meta property="og:title"'+ve.attr("content",d,!0,!0)+">",a&&(i=i+'<meta property="og:image:alt"'+ve.attr("content",d,!0,!0)+">")),n&&(i=(i=i+'<meta name="description"'+ve.attr("content",n,!0,!0)+">")+'<meta property="og:description"'+ve.attr("content",n,!0,!0)+">"),c&&(i=(i=i+'<link rel="canonical"'+ve.attr("href",c,!0,!0)+">")+'<meta property="og:url"'+ve.attr("content",c,!0,!0)+">"),a&&(i=i+'<meta property="og:image"'+ve.attr("content",a,!0,!0)+">"),i+='<meta charset="UTF-8">',i+='<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0">',i+='<meta name="apple-mobile-web-app-capable" content="yes">',i+='<meta http-equiv="X-UA-Compatible" content="ie=edge">',i=(i+='<meta property="og:type" content="website">')+'<meta name="twitter:card"'+ve.attr("content",d&&a?"summary_large_image":"summary",!0,!0)+">",i=(i+='<style media="screen">')+(null==(t=e.css)?"":t)+"</style>",i=(i+="<style>")+(null==(t=r)?"":t)+"</style></head>",i+="<body>",i+=null==(t=s)?"":t,l&&(i=(i+="<script>")+(null==(t=l)?"":t)+"<\/script>"),i+="</body></html>"}).call(this,"bare"in r?r.bare:"undefined"!=typeof bare?bare:void 0,"base"in r?r.base:"undefined"!=typeof base?base:void 0,"css"in r?r.css:"undefined"!=typeof css?css:void 0,"description"in r?r.description:"undefined"!=typeof description?description:void 0,"html"in r?r.html:"undefined"!=typeof html?html:void 0,"image"in r?r.image:"undefined"!=typeof image?image:void 0,"lang"in r?r.lang:"undefined"!=typeof lang?lang:void 0,"title"in r?r.title:"undefined"!=typeof title?title:void 0,"url"in r?r.url:"undefined"!=typeof url?url:void 0,"watchJs"in r?r.watchJs:"undefined"!=typeof watchJs?watchJs:void 0)}catch(e){ve.rethrow(e,void 0,void 0,o[void 0])}return i}function ye(e){var t,i="";try{var o={},r=e||{};(function(e,o,r,n,s,a,p,d,c,l,u){i=(i+="<!DOCTYPE html>")+"<html"+ve.attr("lang",d,!0,!0)+">",i+="<head>",e&&(i=i+"<base"+ve.attr("href",e,!0,!0)+">"),c&&(i=(i=(i+="<title>")+ve.escape(null==(t=c)?"":t)+"</title>")+'<meta property="og:title"'+ve.attr("content",c,!0,!0)+">",p&&(i=i+'<meta property="og:image:alt"'+ve.attr("content",c,!0,!0)+">")),s&&(i=(i=i+'<meta name="description"'+ve.attr("content",s,!0,!0)+">")+'<meta property="og:description"'+ve.attr("content",s,!0,!0)+">"),l&&(i=(i=i+'<link rel="canonical"'+ve.attr("href",l,!0,!0)+">")+'<meta property="og:url"'+ve.attr("content",l,!0,!0)+">"),p&&(i=i+'<meta property="og:image"'+ve.attr("content",p,!0,!0)+">"),i+='<meta charset="UTF-8">',i+='<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0">',i+='<meta name="apple-mobile-web-app-capable" content="yes">',i+='<meta http-equiv="X-UA-Compatible" content="ie=edge">',i=(i+='<meta property="og:type" content="website">')+'<meta name="twitter:card"'+ve.attr("content",c&&p?"summary_large_image":"summary",!0,!0)+">",i=(i+="<style>")+(null==(t=o.css)?"":t)+"</style>",i=(i+="<style>")+(null==(t=n)?"":t)+"</style></head>",i+="<body>",o.progress&&(i+='<div class="bespoke-progress-parent">',i+='<div class="bespoke-progress-bar"></div></div>'),o.osc&&(i+='<div class="bespoke-marp-osc">',i+='<button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">',i+="Previous slide</button>",i+='<span data-bespoke-marp-osc="page"></span>',i+='<button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">',i+="Next slide</button>",i+='<button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">',i+="Toggle fullscreen</button>",i+='<button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">',i+="Open presenter view</button></div>"),i+=null==(t=a)?"":t,r&&r.length>0&&function(){var e=r;if("number"==typeof e.length)for(var o=0,n=e.length;o<n;o++){(s=e[o])&&s.length>0&&(i=i+'<div class="bespoke-marp-note"'+ve.attr("data-index",o,!0,!0)+' tabindex="0">',function(){var e=s;if("number"==typeof e.length)for(var o=0,r=e.length;o<r;o++){var n=e[o];i=(i+="<p>")+ve.escape(null==(t=n)?"":t)+"</p>"}else{r=0;for(var o in e){r++;n=e[o];i=(i+="<p>")+ve.escape(null==(t=n)?"":t)+"</p>"}}}.call(this),i+="</div>")}else{n=0;for(var o in e){var s;n++,(s=e[o])&&s.length>0&&(i=i+'<div class="bespoke-marp-note"'+ve.attr("data-index",o,!0,!0)+' tabindex="0">',function(){var e=s;if("number"==typeof e.length)for(var o=0,r=e.length;o<r;o++){var n=e[o];i=(i+="<p>")+ve.escape(null==(t=n)?"":t)+"</p>"}else{r=0;for(var o in e){r++;n=e[o];i=(i+="<p>")+ve.escape(null==(t=n)?"":t)+"</p>"}}}.call(this),i+="</div>")}}}.call(this),i=(i+="<script>")+(null==(t=o.js)?"":t)+"<\/script>",u&&(i=(i+="<script>")+(null==(t=u)?"":t)+"<\/script>"),i+="</body></html>"}).call(this,"base"in r?r.base:"undefined"!=typeof base?base:void 0,"bespoke"in r?r.bespoke:"undefined"!=typeof bespoke?bespoke:void 0,"comments"in r?r.comments:"undefined"!=typeof comments?comments:void 0,"css"in r?r.css:"undefined"!=typeof css?css:void 0,"description"in r?r.description:"undefined"!=typeof description?description:void 0,"html"in r?r.html:"undefined"!=typeof html?html:void 0,"image"in r?r.image:"undefined"!=typeof image?image:void 0,"lang"in r?r.lang:"undefined"!=typeof lang?lang:void 0,"title"in r?r.title:"undefined"!=typeof title?title:void 0,"url"in r?r.url:"undefined"!=typeof url?url:void 0,"watchJs"in r?r.watchJs:"undefined"!=typeof watchJs?watchJs:void 0)}catch(e){ve.rethrow(e,void 0,void 0,o[void 0])}return i}const ke=l.promisify(d.readFile);function we(e){return L(this,void 0,void 0,(function*(){return(yield ke(p.resolve(__dirname,e))).toString()}))}function xe(e){return L(this,void 0,void 0,(function*(){if(void 0===e)return!1;const t=yield we("watch.js");return`window.__marpCliWatchWS=${JSON.stringify(e)};${t}`}))}var Me={bare:e=>L(void 0,void 0,void 0,(function*(){const t=e.renderer({container:[],inlineSVG:!0,slideContainer:[]});return{rendered:t,result:ge(Object.assign(Object.assign(Object.assign({},e),t),{bare:{css:"body,html{background:#000;height:100%;margin:0;overflow:auto;-ms-scroll-snap-type:y mandatory;scroll-snap-type:y mandatory;-ms-scroll-snap-type:mandatory;scroll-snap-type:mandatory;-ms-scroll-snap-points-y:repeat(100%);scroll-snap-points-y:repeat(100%)}body>svg{display:block;height:100%;scroll-snap-align:center center;width:100%}"},watchJs:yield xe(e.notifyWS)}))}})),bespoke:e=>L(void 0,void 0,void 0,(function*(){var t;const i=e.renderer({container:new I.Element("div",{id:"p"}),inlineSVG:!0,slideContainer:[]});return{rendered:i,result:ye(Object.assign(Object.assign(Object.assign({},e),i),{bespoke:{css:'.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear;-webkit-tap-highlight-color:transparent}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTBMMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMzIgOTBsNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTQwIDcwSDIwVjUwbTIwIDBMMjAgNzBtNDAtNDBoMjB2MjBtLTIwIDBsMjAtMjAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTIwIDUwaDIwdjIwbS0yMCAwbDIwLTIwbTQwIDBINjBWMzBtMjAgMEw2MCA1MCIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS13aWR0aDo1cHh9PC9zdHlsZT48L2RlZnM+PHBhdGggY2xhc3M9ImEiIGQ9Ik0yMCA2MGgtNWE1IDUgMCAwMS01LTVWMjBhNSA1IDAgMDE1LTVoNjBhNSA1IDAgMDE1IDV2NU0zMCA4NWg2MCIvPjxyZWN0IHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIi8+PHJlY3QgY2xhc3M9ImEiIHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNNDAgNTBoNDBNNDAgNjBoMzAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{opacity:0;pointer-events:none;z-index:-1}svg.bespoke-marp-slide.bespoke-marp-active{opacity:1;pointer-events:auto;z-index:0}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{bottom:0;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:rgba(0,0,0,.65);border-radius:7px;bottom:50px;color:#fff;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;z-index:1;will-change:transform}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{flex:0 0 0;background:#0288d1;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:transparent}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{height:100%;left:0;position:absolute;top:0;width:100%;display:grid;grid-template-columns:2fr 1fr;grid-template-rows:minmax(140px,1fr) 2fr 3em;grid-template-areas:"current next" "current note" "info    note"}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;position:relative;overflow:hidden}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{-webkit-filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:transparent;border:0;display:block;-webkit-filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;top:20px;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#ddd;grid-area:note}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{margin:20px;width:calc(100% - 40px);height:calc(100% - 40px);box-sizing:border-box;overflow:auto;padding-right:3px;white-space:pre-wrap;word-wrap:break-word;scrollbar-width:thin;scrollbar-color:hsla(0,0%,86.7%,.5) transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:hsla(0,0%,86.7%,.5);border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#ddd;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{display:block;box-sizing:border-box;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}',js:yield we("bespoke.js"),osc:null===(t=e.osc)||void 0===t||t,progress:e.progress},watchJs:yield xe(e.notifyWS)}))}}))};class Ie{constructor(e,t){this.converter=t.converter,this.events=t.events,this.finder=t.finder,this.mode=t.mode,this.chokidar=N.watch(e,{disableGlobbing:!0,ignoreInitial:!0}).on("change",e=>this.convert(e)).on("add",e=>this.convert(e)).on("unlink",e=>this.delete(e)),this.converter.options.themeSet.onThemeUpdated=e=>this.convert(e),Pe.start()}convert(e){return L(this,void 0,void 0,(function*(){const t=p.resolve(e),i=(yield this.finder()).filter(e=>p.resolve(e.path)===t),o=(yield this.converter.options.themeSet.findPath()).find(e=>p.resolve(e)===t),r=e=>{e.type===de.File&&Pe.sendTo(e.absolutePath,"reload")};try{this.mode===Ie.WatchMode.Convert?yield this.converter.convertFiles(i,{onConverted:e=>{this.events.onConverted(e),r(e.file)}}):this.mode===Ie.WatchMode.Notify&&i.forEach(r)}catch(e){this.events.onError(e)}void 0!==o&&this.converter.options.themeSet.load(t)}))}delete(e){const t=p.resolve(e),{themeSet:i}=this.converter.options;i.unobserve(t),i.themes.delete(t)}static watch(e,t){return new Ie(e,t)}}class Ne{constructor(){this.listeners=new Map}port(){return L(this,void 0,void 0,(function*(){return void 0===this.portNumber&&(this.portNumber=yield S.getPortPromise({port:37717})),this.portNumber}))}register(e){return L(this,void 0,void 0,(function*(){const t=Ne.sha256(e);return this.listeners.has(t)||this.listeners.set(t,new Set),`ws://localhost:${yield this.port()}/${t}`}))}sendTo(e,t){if(!this.wss)return!1;const i=this.listeners.get(Ne.sha256(e));return!!i&&(i.forEach(e=>e.send(t)),!0)}start(e={}){return L(this,void 0,void 0,(function*(){this.wss=new j.Server(Object.assign(Object.assign({},e),{port:yield this.port()})),this.wss.on("connection",(e,t)=>{if(t.url){const[,i]=t.url.split("/"),o=this.listeners.get(i);if(void 0!==o)return this.listeners.set(i,o.add(e)),e.on("close",()=>this.listeners.get(i).delete(e)),void e.send("ready")}e.close()})}))}stop(){void 0!==this.wss&&(this.wss.close(),this.wss=void 0)}static sha256(e){const t=P.createHash("sha256");return t.update(e),t.digest("hex").toString()}}const Pe=new Ne;var Se,je=Ie.watch;!function(e){let t;!function(e){e[e.Convert=0]="Convert",e[e.Notify=1]="Notify"}(t=e.WatchMode||(e.WatchMode={}))}(Ie||(Ie={})),function(e){e.html="html",e.pdf="pdf",e.png="png",e.pptx="pptx",e.jpeg="jpg"}(Se||(Se={}));const Ae={[Se.html]:"text/html",[Se.pdf]:"application/pdf",[Se.png]:"image/png",[Se.pptx]:"application/vnd.openxmlformats-officedocument.presentationml.presentation",[Se.jpeg]:"image/jpeg"};class ze{constructor(e){this.options=e}get template(){const e=Me[this.options.template];return e||ie(`Template "${this.options.template}" is not found.`),e}convert(e,t){return L(this,void 0,void 0,(function*(){const{lang:i,globalDirectives:o,type:r}=this.options,n=e=>!!e&&e.type===de.File;let s="";for(const e of Object.keys(o))void 0!==o[e]&&(s+=`\n\x3c!-- ${e}: ${JSON.stringify(o[e])} --\x3e`);return yield this.template(Object.assign(Object.assign({},this.options.templateOption||{}),{lang:i,base:n(t)&&r!==Se.html?yield(e=>L(this,void 0,void 0,(function*(){return V()?"file:"+(yield $(e.absolutePath)):e.absoluteFileScheme})))(t):void 0,notifyWS:n(t)&&this.options.watch&&r===Se.html?yield Pe.register(t.absolutePath):void 0,renderer:i=>{const o=this.generateEngine(i),r=o.render(`${e}${s}`),a=o[K];return n(t)&&this.options.themeSet.observe(t.absolutePath,null==a?void 0:a.theme),Object.assign(Object.assign({},r),a)}}))}))}convertFile(e,t={}){return L(this,void 0,void 0,(function*(){const i=yield(()=>L(this,void 0,void 0,(function*(){try{return W(!!t.onlyScanning),yield this.convert((yield e.load()).toString(),e)}finally{W(!1)}})))();if(!t.onlyScanning){const o=[];switch(this.options.type){case Se.pdf:o.push(yield this.convertFileToPDF(i,e));break;case Se.png:case Se.jpeg:o.push(...yield this.convertFileToImage(i,e,{pages:this.options.pages,quality:this.options.jpegQuality,type:this.options.type}));break;case Se.pptx:o.push(yield this.convertFileToPPTX(i,e));break;default:o.push(this.convertFileToHTML(i,e))}for(const r of o)yield r.save(),t.onConverted&&t.onConverted({file:e,newFile:r,template:i});return{file:e,template:i,newFile:o[0]}}return{file:e,template:i}}))}convertFiles(e,t={}){return L(this,void 0,void 0,(function*(){const{inputDir:i,output:o}=this.options;!i&&o&&"-"!==o&&e.length>1&&ie("Output path cannot specify with processing multiple files.");for(const i of e)yield this.convertFile(i,t)}))}convertFileToHTML(e,t){const i=t.convert(this.options.output,{extension:"html"});return i.buffer=Buffer.from(e.result),i}convertFileToPDF(e,t){return L(this,void 0,void 0,(function*(){const i=new ce(t.absolutePath);i.buffer=Buffer.from(e.result);const o=t.convert(this.options.output,{extension:"pdf"});return o.buffer=yield this.usePuppeteer(i,(e,t)=>L(this,void 0,void 0,(function*(){return yield e.goto(t,{waitUntil:["domcontentloaded","networkidle0"]}),yield e.pdf({printBackground:!0,preferCSSPageSize:!0})}))),o}))}convertFileToImage(e,t,i){return L(this,void 0,void 0,(function*(){const o=new ce(t.absolutePath);o.buffer=Buffer.from(e.result);const r=[];return yield this.usePuppeteer(o,(o,n)=>L(this,void 0,void 0,(function*(){yield o.setViewport(e.rendered.size),yield o.goto(n,{waitUntil:["domcontentloaded","networkidle0"]}),yield o.emulateMediaType("print");const s=t=>L(this,void 0,void 0,(function*(){return yield o.evaluate(`window.scrollTo(0,${((t||1)-1)*e.rendered.size.height})`),i.type===Se.jpeg?yield o.screenshot({quality:i.quality,type:"jpeg"}):yield o.screenshot({type:"png"})}));if(i.pages)for(let o=1;o<=e.rendered.length;o+=1){const e=t.convert(this.options.output,{page:o,extension:i.type});e.buffer=yield s(o),r.push(e)}else{const e=t.convert(this.options.output,{extension:i.type});e.buffer=yield s(),r.push(e)}}))),r}))}convertFileToPPTX(e,t){return L(this,void 0,void 0,(function*(){const i=yield this.convertFileToImage(e,t,{pages:!0,type:Se.png}),o=new((yield new Promise((function(e){e(function(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach((function(i){var o=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:function(){return e[i]}})})),t.default=e,t}(require("pptxgenjs")))}))).default),r=`${e.rendered.size.width}x${e.rendered.size.height}`;o.author="Created by Marp",o.company="Created by Marp",o.defineLayout({name:r,width:e.rendered.size.width/96,height:e.rendered.size.height/96}),o.layout=r,e.rendered.title&&(o.title=e.rendered.title),e.rendered.description&&(o.subject=e.rendered.description);let n=0;for(const t of i){n+=1;const i=o.addSlide();i.addImage({data:"data:image/png;base64,"+t.buffer.toString("base64")});const[r]=i.relsMedia;i.bkgdImgRid=r.rId,i.data=[];const s=e.rendered.comments[n-1].join("\n\n");s&&i.addNotes(s)}const s=t.convert(this.options.output,{extension:"pptx"});return s.buffer=yield o.write("nodebuffer"),s}))}generateEngine(e){const{html:t,options:i}=this.options,{prototype:o}=this.options.engine,r=Object.assign(Object.assign(Object.assign({},i),e),{html:t}),n=(null==o?void 0:o.hasOwnProperty("constructor"))?new this.options.engine(r):this.options.engine(r);return"function"!=typeof n.render&&ie("Specified engine has not implemented render() method."),void 0!==t&&n.markdown.set({html:t}),n.use(_).use(ee),this.options.themeSet.registerTo(n),n}usePuppeteer(e,i){return L(this,void 0,void 0,(function*(){const{executablePath:o}=yield ze.puppeteerLaunchArgs(),r=yield(()=>{if(!this.options.allowLocalFiles)return;H(`Insecure local file accessing is enabled for conversion from ${e.relativePath()}.`);const t="linux"===process.platform&&(null==o?void 0:o.startsWith("/snap/"));return e.saveTmpFile({home:t,extension:".html"})})(),n=yield(()=>L(this,void 0,void 0,(function*(){return r?V()?"file:"+(yield $(r.path)):"file://"+r.path:"data:text/html;base64,"+e.buffer.toString("base64")})))();try{const e=yield ze.runBrowser(),o=yield e.newPage(),{missingFileSet:s,failedFileSet:a}=this.trackFailedLocalFileAccess(o);try{return yield i(o,n)}finally{s.size>0&&H(`${s.size>1?"Some of t":"T"}he local file${s.size>1?"s are":" is"} missing and will be ignored. Make sure the file path${s.size>1?"s are":" is"} correct.`),a.size>0&&H(`Marp CLI has detected accessing to local file${a.size>1?"s":""}. ${a.size>1?"They are":"That is"} blocked by security reason. Instead we recommend using assets uploaded to online. (Or you can use ${t.yellow("--allow-local-files")} option if you are understood of security risk)`),yield o.close()}}finally{r&&(yield r.cleanup())}}))}trackFailedLocalFileAccess(e){const t=new Set,i=new Set;return e.on("requestfailed",e=>{var o;try{const r=new u.URL(e.url());"file:"===r.protocol&&("net::ERR_FILE_NOT_FOUND"===(null===(o=e.failure())||void 0===o?void 0:o.errorText)?t.add(r.href):i.add(r.href))}catch(e){}}),{missingFileSet:t,failedFileSet:i}}static closeBrowser(){return L(this,void 0,void 0,(function*(){ze.browser&&(yield ze.browser.close())}))}static runBrowser(){return L(this,void 0,void 0,(function*(){return ze.browser||(ze.browser=yield b.launch(Object.assign(Object.assign({},yield ze.puppeteerLaunchArgs()),{userDataDir:yield G("marp-cli-conversion")})),ze.browser.once("disconnected",()=>{ze.browser=void 0})),ze.browser}))}static puppeteerLaunchArgs(){return L(this,void 0,void 0,(function*(){return ze.cachedPuppeteerLaunchArgs||(ze.cachedPuppeteerLaunchArgs=yield Q()),ze.cachedPuppeteerLaunchArgs}))}}class De{constructor(e){this.klass=e}static resolve(e,t){return L(this,void 0,void 0,(function*(){const i=new De(De.resolveModule(e,t));return yield i.resolvePackage(),i}))}static resolveModule(e,t){let i;if((Array.isArray(e)?e:[e]).some(e=>("string"==typeof e?(i=t&&z.silent(p.dirname(p.resolve(t)),e)||z.silent(process.cwd(),e),(null==i?void 0:i.__esModule)&&(i=i.default)):i=e,i)),!i)throw new te("The specified engine has not resolved.");return i}resolvePackage(){return L(this,void 0,void 0,(function*(){const e=this.findClassPath(this.klass);if(!e)return;const t=yield A({cwd:p.dirname(e)});t&&(this.package=require(t))}))}findClassPath(e){for(const t in require.cache){const i=require.cache[t].exports;if(i===e||(null==i?void 0:i.__esModule)&&Object.values(i).includes(e))return t}}}var Te=De.resolve;const Ce=l.promisify(d.lstat),Oe=l.promisify(d.readFile);class Ze{constructor(e,t){this.filename=e,this.overrideName=!0===t.overrideName?this.genUniqName():t.overrideName,this.name=this.overrideName}get buffer(){return this.readBuffer}get css(){const e=this.buffer.toString();return this.overrideName?`${e}\n/* @theme ${this.overrideName} */`:e}load(){return L(this,void 0,void 0,(function*(){this.readBuffer=yield Oe(this.filename)}))}genUniqName(){const e=()=>Math.random().toString(36).slice(2);return`${e()}${e()}${e()}${e()}`}static initialize(e,t={}){return L(this,void 0,void 0,(function*(){const i=new Ze(e,t);return yield i.load(),i}))}}class Le{constructor(e){this.themes=new Map,this.onThemeUpdated=()=>{},this.observedMarkdowns=new Map,this.fn=e.fn,this.fnForWatch=e.fnForWatch}findPath(){return L(this,void 0,void 0,(function*(){return yield Le.findPath(this.fn)}))}load(e){return L(this,void 0,void 0,(function*(){const t=p.resolve(e);let i=this.themes.get(t);i?yield i.load():(i=yield Ze.initialize(t),this.add(i)),void 0!==i.name&&this.notify(i.name)}))}observe(e,t){this.observedMarkdowns.set(e,t)}registerTo(e){for(const t of this.themes.values())try{const i=e.themeSet.add(t.css);t.name=i.name}catch(e){H(`Cannot register theme CSS: ${p.relative(process.cwd(),t.filename)} (${e.message})`)}}unobserve(e){this.observedMarkdowns.delete(e)}add(e){this.themes.set(e.filename,e)}notify(e){this.observedMarkdowns.forEach((t,i)=>{t===e&&this.onThemeUpdated(i)})}static initialize(e,t=[]){return L(this,void 0,void 0,(function*(){const i=[...e,...t.map(e=>e.filename)],o=yield Le.findPath(i),r=new Set(o.map(e=>p.resolve(e)));for(const e of i)if(!k.hasMagic(e.split(p.sep).join("/")))try{const t=yield Ce(e);(t.isFile()||t.isDirectory()||t.isSymbolicLink())&&r.add(p.resolve(e))}catch(e){}const n=new Le({fn:i,fnForWatch:[...r]});for(const e of o)yield n.load(e);return t.forEach(e=>n.add(e)),n}))}static findPath(e){return L(this,void 0,void 0,(function*(){return ce.findPath({expandDirectories:{extensions:[],files:["*.css"]}},...e)}))}}const Be=l.promisify(d.lstat);class Fe{constructor(){this.args={},this.conf={}}static fromArguments(e){return L(this,void 0,void 0,(function*(){const t=new Fe;return t.args=e,yield t.loadConf(e.configFile),t.engine=yield t.args.engine?Te(t.args.engine):t.conf.engine?Te(t.conf.engine,t.confPath):Te(["@marp-team/marp-core",s.Marp]),t}))}converterOption(){var e,t,i,o,r,n,s,a,d,l,u,h;return L(this,void 0,void 0,(function*(){const b=yield this.inputDir(),m=null!==(t=null!==(e=this.args.server)&&void 0!==e?e:this.conf.server)&&void 0!==t&&t,f=(()=>!m&&(void 0!==this.args.output?this.args.output:void 0!==this.conf.output?"-"===this.conf.output||!1===this.conf.output?this.conf.output:p.resolve(p.dirname(this.confPath),this.conf.output):void 0))(),v=this.args.template||this.conf.template||"bespoke",g=(()=>{var e,t,i,o;if("bespoke"===v){const r=this.conf.bespoke||{};return{osc:null!==(t=null===(e=this.args.bespoke)||void 0===e?void 0:e.osc)&&void 0!==t?t:r.osc,progress:null!==(o=null===(i=this.args.bespoke)||void 0===i?void 0:i.progress)&&void 0!==o?o:r.progress}}return{}})(),y=yield this.loadTheme(),k=y instanceof Ze?[y]:[],w=this.args.themeSet||(this.conf.themeSet?(Array.isArray(this.conf.themeSet)?this.conf.themeSet:[this.conf.themeSet]).map(e=>p.resolve(p.dirname(this.confPath),e)):[]),x=yield Le.initialize((b?[b]:[]).concat(w),k);x.themes.size<=k.length&&w.length>0&&H("Not found additional theme CSS files.");const M=(()=>{if(this.args.pdf||this.conf.pdf)return Se.pdf;if(this.args.pptx||this.conf.pptx)return Se.pptx;const e=this.args.images||this.conf.images||this.args.image||this.conf.image;if("png"===e)return Se.png;if("jpeg"===e)return Se.jpeg;const t=(f||"").toLowerCase();return t.endsWith(".pdf")?Se.pdf:t.endsWith(".png")?Se.png:t.endsWith(".pptx")?Se.pptx:t.endsWith(".jpg")||t.endsWith(".jpeg")?Se.jpeg:Se.html})(),I=(()=>{var e,t;const i=null!==(t=null!==(e=this.args.preview)&&void 0!==e?e:this.conf.preview)&&void 0!==t&&t;return i&&process.env.IS_DOCKER?(H("Preview window cannot show in an official docker image. Preview option was ignored."),!1):i})();return{inputDir:b,output:f,preview:I,server:m,template:v,templateOption:g,themeSet:x,type:M,allowLocalFiles:null!==(o=null!==(i=this.args.allowLocalFiles)&&void 0!==i?i:this.conf.allowLocalFiles)&&void 0!==o&&o,engine:this.engine.klass,globalDirectives:{description:null!==(r=this.args.description)&&void 0!==r?r:this.conf.description,image:null!==(n=this.args.ogImage)&&void 0!==n?n:this.conf.ogImage,theme:y instanceof Ze?y.name:y,title:null!==(s=this.args.title)&&void 0!==s?s:this.conf.title,url:null!==(a=this.args.url)&&void 0!==a?a:this.conf.url},html:null!==(d=this.args.html)&&void 0!==d?d:this.conf.html,jpegQuality:null!==(u=null!==(l=this.args.jpegQuality)&&void 0!==l?l:this.conf.jpegQuality)&&void 0!==u?u:85,lang:this.conf.lang||(yield c()).replace(/@/g,"-"),options:this.conf.options||{},pages:!(!this.args.images&&!this.conf.images),watch:(null!==(h=this.args.watch)&&void 0!==h?h:this.conf.watch)||I||m||!1}}))}get files(){return this.args.server||this.conf.server?[]:this.args._||[]}inputDir(){return L(this,void 0,void 0,(function*(){const e=(()=>{if(this.args.inputDir)return p.resolve(this.args.inputDir);if(this.conf.inputDir)return p.resolve(p.dirname(this.confPath),this.conf.inputDir);if((this.args.server||this.conf.server)&&Array.isArray(this.args._)){if(this.args._.length>1)throw new te("Server mode have to specify just one directory.");if(1===this.args._.length)return p.resolve(this.args._[0])}})();if(void 0===e)return;let t;try{t=yield Be(e)}catch(t){if("ENOENT"!==t.code)throw t;throw new te(`Input directory "${e}" is not found.`)}if(!t.isDirectory())throw new te(`"${e}" is not directory.`);return e}))}loadConf(e){return L(this,void 0,void 0,(function*(){const t=a.cosmiconfig(Fe.moduleName);try{const i=yield void 0===e?t.search():t.load(e);i&&(this.confPath=i.filepath,this.conf=i.config)}catch(t){throw new te(["Could not find or parse configuration file.","Error"!==t.name&&`(${t.name})`,void 0!==e&&`[${e}]`].filter(e=>e).join(" "))}}))}loadTheme(){return L(this,void 0,void 0,(function*(){const e=(()=>this.args.theme?{advice:{use:"--theme-set",insteadOf:"--theme"},name:this.args.theme,path:p.resolve(this.args.theme)}:this.conf.theme?{advice:{use:"themeSet",insteadOf:"theme"},name:this.conf.theme,path:p.resolve(p.dirname(this.confPath),this.conf.theme)}:void 0)();if(e){try{return yield Ze.initialize(e.path,{overrideName:!0})}catch(i){if("EISDIR"===i.code)throw q(`Please use ${t.yellow(e.advice.use)} option instead of ${e.advice.insteadOf} to make theme CSS available from directory.`),new te(`Directory cannot pass to theme option. (${e.path})`);if("ENOENT"!==i.code)throw i}return e.name}}))}}Fe.moduleName="marp";var Re=Fe.fromArguments;class We extends T.EventEmitter{}var qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAH0AgMAAAC2uDcZAAAADFBMVEUAAAABiNJnueQBZp1z8GXRAAAAA3RSTlMA/f4BYYQ1AAAFJUlEQVR42u3cuXGeMQyEYZrjwKFLcCluQv24Hlfp4L++kySwCyDwbkzyHekZXYla0zRN0zRN0zRN0zRN0zRN0zRN0zRN0zRN0zRN0zRN0zRNw/fNcrh3cv275fAPdv2n5fAv9mf+y3L4b69kb72SnV03spPrvy2H/5DrRnZy3chOrlu/2nslO7duZefWrezcuvmbfK9kp9bN7NS6mZ1at/9s75XszLqdnVm3szPrjl/peiU7se5gJ9Yd7MS65zf5XsnOq3vYeXUPO6/u+gOuV7LT6i52Wt3FTqv7/m7vleysuo+dVfexs+o+dlbdx06qO9lJdSc7qe5kJ9Wd7Jy6l51T97Jz6l52Tt3LTqm72Sl1Nzul7man1N3sjLqfnVH3szPqfnZG3c9OqAPshDrATqgD7IQ6wI7XEXa8jrDjdYQdryPscB1ih+sQO1yH2OE6xI7WMXa0jrGjdYwdrWPsYB1kB+sgO1gH2cE6yI7VUXasjrJjdZQdq6PsUB1mh+owO1SH2aE6zI7UcXakjrMjdZwdqePsQJ3ADtQJ7ECdwA7UCez+OoPdX2ew++sMdn+dwe6uU9jddQq7u05hd9cp7N46h91b57B76xx2b53D7qyT2J11EruzTmJ31knsvjqL3VdnsfvqLHZfncXuqtPYXXUau6tOY3fVaeyeOo/dU+exe+o8dk+dx+6oE9kddSK7o05kd9SJ7PY6k91eZ7Lb60x2e53Jbq5T2c11Kru5TmU316ns1jqX3VrnslvrXHZrncturJPZjXUyu7FOZjfWyey2OpvdVmez2+psdludzW6q09lNdTq7qU5nN9Xp7JY6n91S57Nb6nx2S53PbqgHsBvqAeyGegC7oR7Avl6PYF+vR7Cv1yPY1+sR7Mv1EPblgyHsy/UQ9uV6CPtqPYZ99WQM+2o9hn21HsO+WA9iXzwaxL5YD2JfrAexr9Wj2NfORrGv1aPY1+pR7Ev1MPalw2HsS/Uw9qXPqul/zn6RP/Y49pXTcewr9Tj2lXrYV/tKPZB94Xgg+0I9kH2hHsg+r0eyz89Hss/rkezzeiT7tB7KPr0Qyj6th7JP66Hss3os++xGLPusHss+q8eyT+rB7JMrweyTejD7pB7MPq5Hs4/vRLOP69Hs43o0+7Aezj68FM4+rIezD+vh7KN6PPvoVjz7qB7PPqrHsw/qCeyDawnsg3oC+6CewH5fz2C/v5fBfl/PYL+vZ7Df1lPYby+msN/WU9hv6ynsd/Uc9rubOex39Rz2u3oO+009if3mahL7TT2J/aaexH5dz2K/vpvFfl3PYr+uZ7Ff1tPYLy+nsV/W09gv62nsV/U89qvbeexX9Tz2q3oe+0U9kf3ieiL7RT2R/aKeyH6uZ7Kf72eyn+uZ7Od6Jvupnsp+eiCV/VRPZT/VU9mP9Vz24wu57Md6Lvuxnst+qCezH55IZj/Uk9kP9WT2fT2bff9GNvu+ns2+r2ez7+rp7LtH0tl39XT2XT2dfVvPZ9++ks++reezb+v57Jt6AfvmmQL2Tb2AfVMvYP/UK9g/71Swf+oV7J96Bfu7XsL+fqiE/V0vYX/XS9hf9Rr210s17K96DfurXsP+rBexP58qYn/Wi9if9SL2R72K/fFWFfujXsX+qFext17J3nole+uV7K1Xsrdeyd56JXvrleytV7K3XsneeiV765XsrVeyt17J3nole+uV7K1Xsmuapmmapmmapmmapmmapmmapmmapmmapmmapmmapmma9p/uH/kiUlWp8dyDAAAAAElFTkSuQmCC";class He extends We{constructor(e={}){super(),this.options={height:e.height||360,width:e.width||640}}get carlo(){return this.carloInternal}open(e){return L(this,void 0,void 0,(function*(){this.emit("opening",e);const t=(yield this.createWindow())||(yield this.launch());t.on("close",()=>this.emit("close",t)),yield t.load(e),this.emit("open",t,e);const{close:i}=t;return t.close=()=>L(this,void 0,void 0,(function*(){try{return yield i.call(t)}catch(e){if(!e.message.includes("Target closed."))throw e}})),t}))}createWindow(){return L(this,void 0,void 0,(function*(){return!!this.carlo&&(yield this.carlo.createWindow({height:this.options.height,width:this.options.width}))}))}launch(){return L(this,void 0,void 0,(function*(){const e=yield Q();return this.carloInternal=yield D.launch({localDataDir:yield G("marp-cli-carlo"),args:e.args,height:this.options.height,width:this.options.width,executablePath:e.executablePath,icon:Buffer.from(qe.slice(22),"base64"),title:"Marp CLI"}),this.carlo.once("exit",()=>{this.emit("exit"),this.carloInternal=void 0}),this.emit("launch"),yield this.carlo.mainWindow()}))}}function Ee(e,t){if(e.type===de.File){const t=e.absolutePath.replace(/\\/g,"/");return encodeURI(`file://${t.startsWith("/")?"":"/"}${t}`)}if(e.buffer)return`data:${Ae[t]};base64,${e.buffer.toString("base64")}`;throw new te("Processing file is not convertible to URI for preview.")}function Ue(e){var t,i="";try{var o={},r=e||{};(function(e,o,r,n,s,a){i+="<!DOCTYPE html>",i+="<html>",i+="<head>",i+='<meta charset="UTF-8">',i+='<meta name="google" content="notranslate">',i+='<meta name="viewport" content="width=device-width initial-scale=1.0">',i=(i+='<meta http-equiv="X-UA-Compatible" content="ie=edge">')+'<link rel="icon" type="image/png"'+ve.attr("href",r,!0,!0)+">",i=(i+="<style>")+(null==(t=a)?"":t)+"</style></head>",i+="<body>",i=(i+="<h1>")+ve.escape(null==(t=e)?"":t)+"</h1>",i+='<label id="show-all-container">',i+='<input class="toggle" id="show-all" type="checkbox">',i+="",i+="\n",i+="Show all files and directories</label>",i+='<ul id="index">',function(){var e=n;if("number"==typeof e.length)for(var r=0,s=e.length;r<s;r++){var a=e[r];i=(i=(i=i+"<li"+ve.attr("class",ve.classes([{convertible:a.convertible,directory:a.directory,nodeModules:a.nodeModules}],[!0]),!1,!0)+">")+'<a class="link file"'+ve.attr("href",o(a.name),!0,!0)+">")+ve.escape(null==(t=a.name)?"":t)+"</a>",a.convertible&&(i=i+'<a class="link pdf"'+ve.attr("href",o(a.name)+"?pdf",!0,!0)+">",i=(i+="PDF</a>")+'<a class="link pptx"'+ve.attr("href",o(a.name)+"?pptx",!0,!0)+">",i+="PPTX</a>"),i+="</li>"}else{s=0;for(var r in e){s++;a=e[r];i=(i=(i=i+"<li"+ve.attr("class",ve.classes([{convertible:a.convertible,directory:a.directory,nodeModules:a.nodeModules}],[!0]),!1,!0)+">")+'<a class="link file"'+ve.attr("href",o(a.name),!0,!0)+">")+ve.escape(null==(t=a.name)?"":t)+"</a>",a.convertible&&(i=i+'<a class="link pdf"'+ve.attr("href",o(a.name)+"?pdf",!0,!0)+">",i=(i+="PDF</a>")+'<a class="link pptx"'+ve.attr("href",o(a.name)+"?pptx",!0,!0)+">",i+="PPTX</a>"),i+="</li>"}}}.call(this),i+="</ul>",i=(i+="<script>")+(null==(t=s)?"":t)+"<\/script></body></html>"}).call(this,"directory"in r?r.directory:"undefined"!=typeof directory?directory:void 0,"encodeURIComponent"in r?r.encodeURIComponent:"undefined"!=typeof encodeURIComponent?encodeURIComponent:void 0,"favicon"in r?r.favicon:"undefined"!=typeof favicon?favicon:void 0,"files"in r?r.files:"undefined"!=typeof files?files:void 0,"script"in r?r.script:"undefined"!=typeof script?script:void 0,"style"in r?r.style:"undefined"!=typeof style?style:void 0)}catch(e){ve.rethrow(e,void 0,void 0,o[void 0])}return i}const Je=l.promisify(d.stat),Xe=l.promisify(d.readFile);class Ye extends We{constructor(e,t={}){super(),e.options.inputDir||ie("Converter have to specify an input directory."),this.converter=e,this.directoryIndex=t.directoryIndex||[],this.inputDir=e.options.inputDir,this.options=t,this.port=Number.parseInt(process.env.PORT,10)||8080}start(){return L(this,void 0,void 0,(function*(){return this.setup(),new Promise((e,t)=>{const i=this.server.listen(this.port);i.on("listening",()=>{e()}),i.on("error",e=>{i.close(),"EADDRINUSE"===e.code?t(new te(e.message)):t(e)})})}))}convertMarkdown(e,t={}){return L(this,void 0,void 0,(function*(){this.converter.options.output=!1,this.converter.options.pages=!1,this.converter.options.type=(()=>{const e=Object.keys(t);return e.includes("pdf")?Se.pdf:e.includes("pptx")?Se.pptx:e.includes("png")?Se.png:e.includes("jpg")||e.includes("jpeg")?Se.jpeg:Se.html})();const i=yield this.converter.convertFile(new ce(e));return this.emit("converted",i),i}))}loadScript(){return L(this,void 0,void 0,(function*(){return void 0===Ye.script&&(Ye.script=(yield Xe(p.resolve(__dirname,"./server/server-index.js"))).toString()),Ye.script}))}preprocess(e,t){var i;return L(this,void 0,void 0,(function*(){const{pathname:o,query:r}=h.parse(e.url);if(!o)return;const n=O.parse(r||""),s=e=>L(this,void 0,void 0,(function*(){try{const i=yield this.convertMarkdown(e,n);if(!i.newFile)throw new Error("Converter must return a converted file to serve.");const{type:o}=this.converter.options;o===Se.pptx&&t.attachment(p.basename(e,p.extname(e))+".pptx"),t.type(Ae[o]).end(i.newFile.buffer)}catch(e){this.emit("error",e),t.status(503).end(e.toString())}})),a=yield this.validateMarkdown(o);if(a.valid)yield s(a.path);else if(null===(i=a.stats)||void 0===i?void 0:i.isDirectory())for(const e of this.directoryIndex){const t=yield this.validateMarkdown(p.join(p.relative(this.inputDir,a.path),e));if(t.valid){yield s(t.path);break}}}))}setup(){this.server=C(),this.server.get("*",(e,t,i)=>this.preprocess(e,t).then(()=>{t.finished||i()})).use(C.static(this.inputDir)).use(Z(this.inputDir,{template:this.template.bind(this)}))}template(e,t){const{directory:i,path:o,fileList:r}=e,n=[];(()=>{L(this,void 0,void 0,(function*(){const e=yield this.loadScript();for(const e of r){const{name:t,stat:i}=e,o=null==i?void 0:i.isDirectory(),r=".."===t&&o,s="node_modules"===t&&o,a=!r&&(yield this.validateMarkdown(t,i)).valid;n.push({convertible:a,directory:o,name:t,nodeModules:s,parent:r,stat:i})}t(null,Ue({directory:i,favicon:qe,files:n,path:o,script:e,style:'body{background:#fff;color:#444;font-size:15px}h1{font-size:26px}ul#index{list-style:none;margin:1em 2em;max-width:720px;padding:0}ul#index li{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBkPSJNNzAgMzBMNTMuNTQgMTMuNTRDNTEuNTkgMTEuNTkgNTAgMTIuMjUgNTAgMTV2MjBhNSA1IDAgMDA1IDVoMjBhNSA1IDAgMDE1IDV2NDBhNSA1IDAgMDEtNSA1SDI1YTUgNSAwIDAxLTUtNVYxNWE1IDUgMCAwMTUtNWgxNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNjY2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iNSIvPjwvc3ZnPg==");background-size:24px 24px;background-repeat:no-repeat;background-position:0;display:flex;height:30px;margin:5px 0 0;opacity:.5;padding:0 0 0 calc(24px + .5em)}ul#index li.convertible{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+Lmx7ZmlsbDpub25lO3N0cm9rZTojMDI4OGQxO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJsIiBkPSJNMzYuNzEgNzYuNzlsNTMuNTctNTMuNTh2NTMuNThIMzYuNzF6Ii8+PHBhdGggY2xhc3M9ImwiIGQ9Ik0xMCA3Ni43OWw1My41Ny01My41OHY1My41OEgxMHoiLz48L3N2Zz4=");opacity:1}ul#index li.directory{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBkPSJNODIgMzBINTdhMTMuOTEgMTMuOTEgMCAwMS04LjU0LTMuNTRsLTIuOTItMi45MkExMy45MSAxMy45MSAwIDAwMzcgMjBIMTdhNSA1IDAgMDAtNSA1djUwYzAgMi43NS41NSAyLjgyIDEuMjEuMTVsNy41OC0zMC4zQTYuNzQgNi43NCAwIDAxMjcgNDBoNjBhMy43MyAzLjczIDAgMDEzLjc5IDQuODVsLTcuNTggMzAuM0E2Ljc0IDYuNzQgMCAwMTc3IDgwSDIyIiBmaWxsPSJub25lIiBzdHJva2U9IiM2NjYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1Ii8+PC9zdmc+")}ul#index li.directory:not(.nodeModules){opacity:1}ul#index li a.link{border-radius:5px;box-sizing:border-box;color:#02669d;display:block;height:30px;line-height:20px;padding:5px 10px;text-decoration:none}ul#index li a.link:focus,ul#index li a.link:hover{background:#f8f8f8;text-decoration:underline}ul#index li a.link:hover:active{background:#f0f0f0}ul#index li a.link.file{flex:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}ul#index li a.link.pdf,ul#index li a.link.pptx{flex:0 1 auto;font-size:14px;margin:0 0 0 .5em}ul#index li a.link.pdf{color:#ee1d1f}ul#index li a.link.pptx{color:#b7472a}ul#index:not(.show-all) li.nodeModules,ul#index:not(.show-all) li:not(.convertible):not(.directory){display:none}#show-all-container{cursor:pointer;display:block;font-size:.85em;margin:1em 2em;max-width:720px;text-align:right}input.toggle[type=checkbox]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#666;border-radius:16px;cursor:pointer;display:inline-block;height:16px;margin:0;outline:0;position:relative;transition:background-color .2s ease-out;vertical-align:middle;width:32px}input.toggle[type=checkbox]:before{border-radius:20px;border:1px solid transparent;bottom:-2px;box-sizing:border-box;content:"";display:block;left:-2px;opacity:.75;position:absolute;right:-2px;top:-2px;transition:border-color .2s ease-out}input.toggle[type=checkbox]:after{background:#fff;border-radius:12px;content:"";display:inline-block;height:12px;left:2px;margin:0 auto 0 0;position:absolute;top:2px;transition:left .2s ease-out;width:12px}input.toggle[type=checkbox]:focus:before{border-color:#555}input.toggle[type=checkbox]:checked{background-color:#6c6}input.toggle[type=checkbox]:checked:focus:before{border-color:#6c6}input.toggle[type=checkbox]:checked:after{left:calc(100% - 14px)}input.toggle[type=checkbox]:hover:active{background-color:#555;transition:none}input.toggle[type=checkbox]:hover:active:checked{background-color:#5b5}'}))}))})()}validateMarkdown(e,t){return L(this,void 0,void 0,(function*(){const i=p.extname(e).slice(1);let o=pe.includes(i);const r=p.resolve(this.inputDir),n=p.join(r,decodeURIComponent(e));if(!n.startsWith(r))return{valid:!1,path:n};let s;try{s=t||(yield Je(n)),o=o&&!!(null==s?void 0:s.isFile())}catch(e){o=!1}return{valid:o,stats:s,path:n}}))}}function Ve(e){return L(this,void 0,void 0,(function*(){let t="";const{engine:i}=e;return i.klass===s.Marp?(t="@marp-team/marp-core v1.1.1",i.package&&"1.1.1"!==i.package.version&&(t="user-installed @marp-team/marp-core v"+i.package.version)):t=i.package&&i.package.name&&i.package.version?`customized engine in ${i.package.name} v${i.package.version}`:"customized engine",console.log("@marp-team/marp-cli v0.17.4"+(t?` (w/ ${t})`:"")),0}))}var $e;!function(e){e.Basic="Basic Options:",e.Converter="Converter Options:",e.Template="Template Options:",e.Meta="Meta Options:",e.Marp="Marp / Marpit Options:"}($e||($e={}));const Ge="\nUsage:\n  marp [options] <files...>\n  marp [options] -I <dir>\n".trim();exports.default=function(e=[]){return L(this,void 0,void 0,(function*(){let o;try{const r=i(e).usage(Ge).help(!1).version(!1).options({version:{alias:"v",describe:"Show versions",group:$e.Basic,type:"boolean"},help:{alias:"h",describe:"Show help",group:$e.Basic,type:"boolean"},output:{alias:"o",describe:"Output file path (or directory when input-dir is passed)",group:$e.Basic,type:"string"},"input-dir":{alias:"I",describe:"The base directory to find markdown and theme CSS",group:$e.Basic,type:"string"},"config-file":{alias:"c",describe:"Specify path to configuration file",group:$e.Basic,type:"string"},watch:{alias:"w",describe:"Watch input markdowns for changes",group:$e.Basic,type:"boolean"},server:{alias:"s",describe:"Enable server mode",group:$e.Basic,type:"boolean"},preview:{alias:"p",describe:"Open preview window (EXPERIMENTAL)",hidden:!0,group:$e.Basic,type:"boolean"},stdin:{default:!0,describe:"Read Markdown from stdin",hidden:!0,group:$e.Basic,type:"boolean"},pdf:{conflicts:["image","images","pptx"],describe:"Convert slide deck into PDF",group:$e.Converter,type:"boolean"},pptx:{conflicts:["pdf","image","images"],describe:"Convert slide deck into PowerPoint document",group:$e.Converter,type:"boolean"},image:{conflicts:["pdf","images","pptx"],describe:"Convert the first slide page into an image file",group:$e.Converter,choices:["png","jpeg"],coerce:e=>"jpg"===e?"jpeg":e,type:"string"},images:{conflicts:["pdf","image","pptx"],describe:"Convert slide deck into multiple image files",group:$e.Converter,choices:["png","jpeg"],coerce:e=>"jpg"===e?"jpeg":e,type:"string"},"jpeg-quality":{defaultDescription:"85",describe:"Setting JPEG image quality",group:$e.Converter,type:"number"},"allow-local-files":{describe:"Allow to access local files from Markdown while converting PDF and image (NOT SECURE)",group:$e.Converter,type:"boolean"},template:{describe:"Choose template",defaultDescription:"bespoke",group:$e.Template,choices:Object.keys(Me),type:"string"},"bespoke.osc":{describe:"[Bespoke] Use on-screen controller",defaultDescription:"true",group:$e.Template,type:"boolean"},"bespoke.progress":{describe:"[Bespoke] Use progress bar",defaultDescription:"false",group:$e.Template,type:"boolean"},title:{describe:"Define title of the slide deck",group:$e.Meta,type:"string"},description:{describe:"Define description of the slide deck",group:$e.Meta,type:"string"},url:{describe:"Define canonical URL",group:$e.Meta,type:"string"},"og-image":{describe:"Define Open Graph image URL",group:$e.Meta,type:"string"},engine:{describe:"Select Marpit based engine by module name or path",group:$e.Marp,type:"string"},html:{describe:"Enable or disable HTML tag",group:$e.Marp,type:"boolean"},theme:{describe:"Override theme by name or CSS file",group:$e.Marp,type:"string"},"theme-set":{array:!0,describe:"Path to additional theme CSS files",group:$e.Marp,type:"string"}}),n=r.argv;if(n.help)return r.showHelp(),0;const s=yield Re(n);if(n.version)return yield Ve(s);const a=new ze(yield s.converterOption()),p=a.options,d=()=>L(this,void 0,void 0,(function*(){if(p.inputDir)return s.files.length>0?(E("Cannot pass files together with input directory."),[]):ce.findDir(p.inputDir);return[n.stdin?yield ce.stdin():void 0,...yield ce.find(...s.files)].filter(e=>e)})),c=yield d(),{length:l}=c;if(0===l)return s.files.length>0&&H("Not found processable Markdown file(s).\n"),r.showHelp(),s.files.length>0?1:0;const u=[],h=e=>{const{file:t,newFile:i}=e;if(!i)return;const o=(e,t)=>e.type===de.StandardIO?t:e.relativePath();u.push(i),q(`${o(t,"<stdin>")} ${i.type===de.Null?"processed.":"=> "+o(i,"<stdout>")}`,{singleLine:!0})};try{p.server?yield a.convertFiles(c,{onlyScanning:!0}):(q(`Converting ${l} markdown${l>1?"s":""}...`),yield a.convertFiles(c,{onConverted:h}))}catch(e){ie(`Failed converting Markdown. (${e.message})`,e.errorCode)}if(p.watch){o=je([...p.inputDir?[p.inputDir]:s.files,...p.themeSet.fnForWatch],{converter:a,finder:d,events:{onConverted:h,onError:e=>E(`Failed converting Markdown. (${e.message})`)},mode:p.server?Ie.WatchMode.Notify:Ie.WatchMode.Convert});const e=new He;if(e.on("exit",()=>process.exit()),e.on("opening",e=>{H(`${t.yellow`[DEPRECATION WARNING]`} Due to the unmaintained dependent package ${t.cyan`carlo`} and incompatible Chrome / Chromium >= 81, the EXPERIMENTAL preview option provided by ${t.yellow`--preview`} or ${t.yellow`-p`} may no longer work correctly. See details: ${t.blueBright`https://github.com/marp-team/marp-cli/issues/211`}`);const i=`[Preview] (EXPERIMENTAL) Opening ${e.substr(0,50)}...`;q(t.cyan(i))}),p.server){const i=new Ye(a,{directoryIndex:["index.md","PITCHME.md"]});i.on("converted",h),i.on("error",e=>E(e.toString())),yield i.start();const o="http://localhost:"+i.port,r=`[Server mode] Start server listened at ${o}/ ...`;q(t.green(r)),p.preview&&(yield e.open(o))}else if(q(t.green("[Watch mode] Start watching...")),p.preview)for(const t of u)p.type!==Se.pptx&&(yield e.open(Ee(t,p.type)))}return 0}catch(e){if(!(e instanceof te))throw e;return E(e.message),Pe.stop(),o&&o.chokidar.close(),e.errorCode}finally{yield ze.closeBrowser()}}))};
